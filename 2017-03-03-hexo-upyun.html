<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=1"><meta name="renderer" content="webkit"><title>Hexo与Upyun如何更好的在一起搞基（误） | BLOG | HDSKY</title><meta name="format-detection" content="telephone=no"><meta name="description" content="最近博客从Wordpress迁移至hexo，一是因为原来的腾讯云学生机的带宽太低，二是在学生服务器过期后有迁移至Github的想法，不如早点动手（23333333333），hexo的搭建以及各种加特技就不再多说了，网上有很多对应的教程。在迁移至hexo后速度依旧不太理想，然后就想着加入CDN的大军，在网上寻找了半天没有比较合适的教程，也踩了不少的坑，在此记录下来，为后面来的小伙伴指条明路0.0。"><meta name="keywords" content="黑&amp;蛋,个人博客,Linux,Ubuntu,Centos,HPC,tag.name,tag.name"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="applicable-device" content="pc,mobile"><link href="/dist/iris-20b518ec25.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/instant.page@3.0.0/instantpage.min.js" type="module" defer></script><script>var TinyCache=function(){"use strict";var n=window.localStorage,t=document;function e(n){return new Error("Failed to load "+n.name+": "+n.url)}function r(n){return new Error("No such item or item is staled: "+n.name)}function o(n,e){var r=t.createElement("script");r.id=n.name,r.text=e,r.defer=!0,t.getElementsByTagName("head")[0].appendChild(r)}function i(n,r){var o=t.createElement("script");o.id=n.name,o.src=n.url,o.onload=function(){r(null)},o.onerror=function(){r(e(n))},t.getElementsByTagName("body")[0].appendChild(o)}function u(t,e,r){!function(t,e){try{n.setItem(t,JSON.stringify(e))}catch(t){}}(""+t+e.name,{content:r,expire:e.maxAge?(new Date).getTime()+1e3*e.maxAge:null,name:e.name,url:e.url})}return function(){function t(n){this.config={prefix:"TC:",timeout:6e3},function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])}(this.config,n)}var a=t.prototype;return a.load=function(n,t){var e,r,o,i,u=this;if(!t)return new Promise((function(t,e){u.load(n,(function(n){n?e(n):t()}))}));e=n.map((function(n){return function(t){u.loadScript(n,t)}})),r=t,o=[],i=e.length,e.forEach((function(n,t){n((function(n,e){o[t]=e,n&&r&&(r(n),r=null),0==--i&&r&&r(null,o)}))}))},a.remove=function(n){!function(n){try{localStorage.removeItem(n)}catch(n){}}(""+this.config.prefix+n.name)},a.loadScript=function(t,a){var c=this;!function(t,e,o){var i=function(t){var e,r=null;try{var o=n.getItem(t);o&&(r=JSON.parse(o))&&("string"!=typeof(e=r).name||"string"!=typeof e.url||"string"!=typeof e.content)&&(r=null)}catch(t){}return r}(""+t+e.name);i?i.url!==e.url||i.expire&&i.expire<(new Date).getTime()?o(r(e)):o(null,i.content):o(r(e))}(this.config.prefix,t,(function(n,r){var l,f,m,s;n?(l=t,f=c.config.timeout,m=function(n,e){e&&!n?(o(t,e),u(c.config.prefix,t,e),a(null)):i(t,a)},(s=new XMLHttpRequest).open("GET",l.url,!0),s.timeout=f,s.onload=function(){200<=s.status&&s.status<300||304===s.status?m(null,s.responseText):m(e(l))},s.ontimeout=s.onerror=function(){m(e(l))},s.send()):r?(o(t,r),a(null)):i(t,a)}))},t}()}()</script><script>(new TinyCache).load([{url:"/dist/iris-dfae13bc3a.js",name:"iris"}])</script><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="//www.googletagmanager.com"><link rel="dns-prefetch" href="//hdsky-pw.disqus.com"><link rel="shortcut icon" type="image/ico" href="/favicon.ico"><link rel="icon" type="image/png" href="/favicon-192x192.png"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta property="og:title" content="Hexo与Upyun如何更好的在一起搞基（误） | BLOG | HDSKY"><meta property="og:type" content="blog"><meta property="og:url" content="https://hdsky.pw/2017-03-03-hexo-upyun.html"><meta property="og:image" content="/favicon-192x192.png"><meta property="og:description" content="最近博客从Wordpress迁移至hexo，一是因为原来的腾讯云学生机的带宽太低，二是在学生服务器过期后有迁移至Github的想法，不如早点动手（23333333333），hexo的搭建以及各种加特技就不再多说了，网上有很多对应的教程。在迁移至hexo后速度依旧不太理想，然后就想着加入CDN的大军，在网上寻找了半天没有比较合适的教程，也踩了不少的坑，在此记录下来，为后面来的小伙伴指条明路0.0。"><meta property="og:article:tag" content="黑&amp;蛋,个人博客,Linux,Ubuntu,Centos,HPC,tag.name,tag.name"><meta property="og:locale" content="zh-Hans"><meta property="article:published_time" content="Fri Mar 03 2017 19:20:06 GMT+0800"><meta property="article:modified_time" content="Tue Jun 28 2022 00:08:48 GMT+0800"><meta name="twitter:card" content="summary"><script async src="https://www.googletagmanager.com/gtag/js?id=G-BNEM1LH28R"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BNEM1LH28R")</script><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://hdsky.pw"
    },
    "headline": "Hexo与Upyun如何更好的在一起搞基（误）",
    
    "datePublished": "2017-03-03T11:20:06.000Z",
    "dateModified": "2022-06-27T16:08:48.269Z",
    "author": {
        "@type": "Person",
        "name": "黑&amp;蛋",
        "image": {
            "@type": "ImageObject",
            "url": "avatar.png"
        },
        "description": "黑&amp;蛋的个人博客"
    },
    "publisher": {
        "@type": "Organization",
        "name": "BLOG | HDSKY",
        "logo": {
            "@type": "ImageObject",
            "url": "/favicon-192x192.png"
        }
    },
    "keywords": "黑&amp;蛋,个人博客,Linux,Ubuntu,Centos,HPC,tag.name,tag.name",
    "description": "最近博客从Wordpress迁移至hexo，一是因为原来的腾讯云学生机的带宽太低，二是在学生服务器过期后有迁移至Github的想法，不如早点动手（23333333333），hexo的搭建以及各种加特技就不再多说了，网上有很多对应的教程。在迁移至hexo后速度依旧不太理想，然后就想着加入CDN的大军，在网上寻找了半天没有比较合适的教程，也踩了不少的坑，在此记录下来，为后面来的小伙伴指条明路0.0。"
}</script><script>"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){e.map((function(e){e.unregister()}))}))</script><meta name="generator" content="Hexo 7.3.0"></head><body data-instant-intensity="viewport"><header class="header header__no-hero"><div class="header-wrapper"><div class="header__left"><div class="header-logo"><a href="/">BLOG | HDSKY</a></div></div><div class="header__right"><nav class="nav"><a id="nav-toggle" class="nav-toggle"><div></div></a><div class="nav-wrapper"><ul><li><a class="nav-link" href="/links">Link</a></li><li><a class="nav-link" href="/archives">Archive</a></li><li><a class="nav-link" href="/about">About</a></li></ul></div></nav></div></div></header><main class="main"><article class="post"><header class="post-header"><h1 class="post-title">Hexo与Upyun如何更好的在一起搞基（误）</h1><section class="post-meta"><time datetime="2017-03-03T11:20:06.000Z"><i class="far fa-calendar" aria-hidden></i> 2017-03-03</time></section></header><aside class="post-aside"><section class="post-toc"><header class="post-toc-title">Contents</header><ol class="post-toc-inst"><li class="post-toc-inst-item post-toc-inst-level-1"><a class="post-toc-inst-link" href="#%E5%9C%A8Upyun%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA%E8%B4%A6%E5%8F%B7"><span class="post-toc-inst-number">1.</span> <span class="post-toc-inst-text">在Upyun注册一个账号</span></a></li><li class="post-toc-inst-item post-toc-inst-level-1"><a class="post-toc-inst-link" href="#%E5%88%9B%E5%BB%BA%E6%88%90%E5%8A%9F%E5%B9%B6%E8%BF%9B%E5%85%A5%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2"><span class="post-toc-inst-number">2.</span> <span class="post-toc-inst-text">创建成功并进入服务管理界面</span></a></li><li class="post-toc-inst-item post-toc-inst-level-1"><a class="post-toc-inst-link" href="#%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="post-toc-inst-number">3.</span> <span class="post-toc-inst-text">插件安装的方式</span></a></li><li class="post-toc-inst-item post-toc-inst-level-1"><a class="post-toc-inst-link" href="#%E5%A6%82%E6%9E%9C%E6%98%BE%E7%A4%BAdeploy-done%E7%9A%84%E8%AF%9D%E5%B0%B1%E6%98%AF%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F%E5%95%A6"><span class="post-toc-inst-number">4.</span> <span class="post-toc-inst-text">如果显示deploy done的话就是上传成功啦~</span></a></li><li class="post-toc-inst-item post-toc-inst-level-1"><a class="post-toc-inst-link" href="#%E4%B8%BA%E4%BD%A0%E7%9A%84Upyun%E6%B7%BB%E5%8A%A0HTTPS%E6%94%AF%E6%8C%81%E3%80%82"><span class="post-toc-inst-number">5.</span> <span class="post-toc-inst-text">为你的Upyun添加HTTPS支持。</span></a></li></ol></section></aside><section class="post-content"><p>最近博客从Wordpress迁移至hexo，一是因为原来的腾讯云学生机的带宽太低，二是在学生服务器过期后有迁移至Github的想法，不如早点动手（23333333333），hexo的搭建以及各种加特技就不再多说了，网上有很多对应的教程。在迁移至hexo后速度依旧不太理想，然后就想着加入CDN的大军，在网上寻找了半天没有比较合适的教程，也踩了不少的坑，在此记录下来，为后面来的小伙伴指条明路0.0。 <span id="more"></span><br>　<br>首先需要说明的是最开始我选择的是腾讯云+upyun的自主源站，但后面发现这种的效果不好，适用于访问量较大的网站，但自己的网站太小了orz，因为经常修改网页，所以很多的网页以及资源不能及时的缓存至CDN，在之后选择了又拍云作为源站，这样全站就开启了CDN，速度UP。所以下面的内容是以又拍云为源站为示例，自主源站的配置与之类似，敬请参考。</p><h1 id="在Upyun注册一个账号"><a href="#在Upyun注册一个账号" class="headerlink" title="在Upyun注册一个账号"></a>在Upyun注册一个账号</h1><p><a target="_blank" rel="noopener" href="https://www.upyun.com/">https://www.upyun.com/</a><br>然后创建一个服务，这里我们选择的是全网加速服务。</p><img src="/images/2017/hexo-upyun/1.png" width="800"><p>在这里我们选择以又拍云作为源站（因为我之前已经创建过服务，所以这里显示服务名已存在）</p><img src="/images/2017/hexo-upyun/2.png" width="800"><p>在为服务授权这里需要创建操作员，当然你直接使用管理员账户也是可以的；<br>在此处创建的操作员账户和密码需要自己记住，我们后面需要用到。</p><img src="/images/2017/hexo-upyun/3.png" width="800"><h1 id="创建成功并进入服务管理界面"><a href="#创建成功并进入服务管理界面" class="headerlink" title="创建成功并进入服务管理界面"></a>创建成功并进入服务管理界面</h1><p>在这里是对创建的服务进行操作的地方，值得注意的是，要是用自己的域名作为访问地址的话，需要在域名服务商处将CNAME 配置为又拍云指定的地址，并且域名需要备案。</p><img src="/images/2017/hexo-upyun/4.png" width="800"><p>下一步我们需要对已有的操作员进行授权，或者新创建一个操作员，并将其与本服务相关联。需要赋予操作员读取写入以及删除的权限。</p><img src="/images/2017/hexo-upyun/5.png" width="800"> <img src="/images/2017/hexo-upyun/6.png" width="800"> <img src="/images/2017/hexo-upyun/7.png" width="800"><p>建议开启其中的代码压缩功能，能够优化hexo生成的html文件</p><img src="/images/2017/hexo-upyun/8.png" width="800"><p>　　至此在又拍云中需要完成的工作已经结束了，下面让我们回到本地的hexo中进行配置，并以win平台为例，详细讲解如何将本地生成的网页上传至又拍云中。我选择的是使用FTP的方式将网站所有资源上传至又拍云的存储空间中，因为hexo生成的文件为纯静态的，所以直接上传全部资源至CDN即可，你甚至不需要有自己的服务器，我就是这么干的(～￣▽￣)～<br>　　如果你的网站不是很频繁的更新的话，可以使用FTP客户端，根据官方的文档<a target="_blank" rel="noopener" href="http://docs.upyun.com/api/developer_tools/#ftpftps">http://docs.upyun.com/api/developer_tools/#ftpftps</a> 使用FTP软件直接将生成的.&#x2F;public文件夹中的所有内容上传至又拍云提供的空间当中。<br>　　当然这么做也是一种非常笨的办法，而在hexo中，你可以选择安装插件的方式来解放你的双手，在此感谢第三方开发者的辛勤劳动（世界因你而变得美好），项目地址： <a target="_blank" rel="noopener" href="https://github.com/Menci/hexo-deployer-upyun/">https://github.com/Menci/hexo-deployer-upyun/</a></p><h1 id="插件安装的方式"><a href="#插件安装的方式" class="headerlink" title="插件安装的方式"></a>插件安装的方式</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-upyun --save</span><br></pre></td></tr></table></figure><img src="/images/2017/hexo-upyun/9.png" width="800"><p>　　在安装完成后，我们需要对插件进行一些修改，因为一些历史问题，我们知道Linux与Win的系统使用的是不同的斜杠分隔（”&#x2F;“与”&quot;），在Linux的系统中不会出现问题，所以在Win中我们需要对这部分文件进行替换。需要替换的文件地址在：<a target="_blank" rel="noopener" href="https://github.com/Menci/hexo-deployer-upyun/tree/fix-win32-path">https://github.com/Menci/hexo-deployer-upyun/tree/fix-win32-path</a><br>　　我们只需要下载下面的两个文件，并替换掉blog插件目录下的同名文件即可（我的目录为D:\OneDrive\blog\node_modules\hexo-deployer-upyun\）具体情况视自己的环境而定。不然的话上传文件时候，在FTP上子文件夹不会在母文件夹的目录下，而是会单独出现在FTP中。</p><img src="/images/2017/hexo-upyun/10.png" width="800"><p>　　接下来是对hexo的配置文件进行修改，使其能够在本地编译完成后自动上传至又拍云的空间当中。我们需要打开hexo目录下的_config.yml文件对其修改而并非是主题（themes）目录下的_config.yml文件，添加以下的代码并修改对应的信息。如果之前部署过hexo-deployer插件的小伙伴应该对此相当熟悉了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: upyun </span><br><span class="line">  bucket: bucket #服务名</span><br><span class="line">  operator: operator #操作员名</span><br><span class="line">  password: password #操作员密码</span><br><span class="line">  endpoint: v0.api.upyun.com</span><br><span class="line">  secret: secret</span><br><span class="line">  try_times: 5</span><br><span class="line">  ignore_path_re:</span><br><span class="line">    dir: null</span><br><span class="line">    file: &quot;.DS_Store$&quot;</span><br></pre></td></tr></table></figure><p>这里值得注意的是需要按又拍云的要求填写相应的部分：<br>FTP&#x2F;FTPS 登录方式<br>地址（主机)：<br>智能选路（推荐）：v0.ftp.upyun.com<br>电信线路：v1.ftp.upyun.com<br>联通线路：v2.ftp.upyun.com<br>移动线路：v3.ftp.upyun.com<br>加密：选择 不加密 使用 FTP，选择 显式的 FTP over TLS 或 TLS&#x2F;SSL 显式加密 使用 FTPS<br>用户名：操作员名&#x2F;服务名，如 operator&#x2F;mybucket<br>密码：操作员的密码<br>端口：21</p><p>配置完成后即可保存，然后再命令行使用下面的命令将hexo编译并上传至又拍云。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><h1 id="如果显示deploy-done的话就是上传成功啦"><a href="#如果显示deploy-done的话就是上传成功啦" class="headerlink" title="如果显示deploy done的话就是上传成功啦~"></a>如果显示deploy done的话就是上传成功啦~</h1><p>（这里在我的电脑不会出现上传的文件名，可能是个BUG）</p><img src="/images/2017/hexo-upyun/11.png" width="400"><p>至此hexo就部署到了你的又拍云上面，你可以尝试使用又拍云提供的测试域名进行访问测试。</p><h1 id="为你的Upyun添加HTTPS支持。"><a href="#为你的Upyun添加HTTPS支持。" class="headerlink" title="为你的Upyun添加HTTPS支持。"></a>为你的Upyun添加HTTPS支持。</h1><p>让你的网站更安全也更容易被搜索引擎收录。<br>　　在现在网络的新形势下，HTTPS已逐渐成为一种潮流，而主流的几款浏览器（Chrome，Firefox等）已将原来的HTTP格式的网页标记为不安全。虽然加入HTTPS需要增加一些成本，但在这里值得注意的是，又拍云提供了相应的服务，使得我们能够快速便捷的将自己的网站添加HTTPS的支持。<br>　　又拍云与 TrustAsia 达成战略合作，携手推出了免费版域名型 DV SSL 证书（由 Symantec 签发）的申请，有效期一年，原价 1900 元&#x2F;年。同时又拍云还与国际证书提供商 Let’s Encrypt 合作，为用户免费提供了另一款 DV SSL 证书的申请，证书到期自动续签，操作简单方便，一键完成证书的申请与部署。如果域名当前已有证书，又拍云也提供了自有证书的上传方式，无需人工协助，安全便捷。<br>　　在这里我们选择的是，从又拍云申请Let’s Encrypt的DV证书，这种方式对于个人用户而言非常适合，首先它是免费的，尽管有有效期，但到期后又拍云会帮你实现自动续期，所以非常的省时省力省心。<br>点击控制台的工具箱中的SSL证书服务，进入到了证书申购中。</p><img src="/images/2017/hexo-upyun/12.png" width="800"><p>点击右下角的申购证书，选择Let’s Encrypt证书。</p><img src="/images/2017/hexo-upyun/13.png" width="400"><p>输入你要申请的证书域名，并验证所有权，通过验证后即可生效。</p><img src="/images/2017/hexo-upyun/14.png" width="400"> <img src="/images/2017/hexo-upyun/15.png" width="400"><p>然后将证书与你的又拍云服务相关联，并建议开启强制HTTPS服务。</p><img src="/images/2017/hexo-upyun/16.png" width="800"><p>最后尝试下访问你自己的站，如果看到自己的网站有HTTPS并且提示安全，那么本次的HTTPS配置工作就圆满完成了（撒花~）</p><img src="/images/2017/hexo-upyun/17.png" width="200"></section><footer class="post-meta"><section class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF%E6%94%B9%E5%8F%98%E7%94%9F%E6%B4%BB/"><i class="fas fa-folder"></i> 技术改变生活</a></section><section class="tags"><a href="/tags/%E6%8A%80%E6%9C%AF/"><i class="fas fa-tag" aria-hidden></i> 技术 </a><a href="/tags/Upyun/"><i class="fas fa-tag" aria-hidden></i> Upyun</a></section></footer><div class="post-end" data-text="End"></div></article><section><div id="disqus_thread"></div><script>!function(s){window.DISQUS=null;var e=s.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/disqusjs@1.2.3/dist/disqusjs.css",s.head.appendChild(e);var n=s.createElement("script");n.async=!0,n.src="https://cdn.jsdelivr.net/npm/disqusjs@1.2.3/dist/disqus.js",n.onload=function(){new DisqusJS({shortname:"hdsky-pw",siteName:"BLOG | HDSKY",identifier:"2017-03-03-hexo-upyun",url:"https://hdsky.pw/2017-03-03-hexo-upyun.html",title:"Hexo与Upyun如何更好的在一起搞基（误）",api:"",apikey:"nvPDNH7YoE53bGKClf2CTyHqz9pYcnEsDoMFdpBEdarIrYJNfsdSDrAioHU5292n",admin:"disqus_trck5pCCAM",adminLabel:""})},s.head.appendChild(n)}(document)</script></section></main><footer class="footer"><div class="footer-wrapper"><p class="copyright">&copy; 2016 - 2024 黑&amp;蛋</p><p class="theme">Hexo Theme <a href="https://github.com/giuem/hexo-theme-iris" target="_blank" rel="noopener noreferrer">Iris</a> with <i class="fas fa-heart"></i></p></div></footer></body></html>